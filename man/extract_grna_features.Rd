% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gRNA_feature_extraction.R
\name{extract_grna_features}
\alias{extract_grna_features}
\title{Extract sequence features for SHAP analysis}
\usage{
extract_grna_features(scores_df)
}
\arguments{
\item{scores_df}{Data frame from score_grnas_multi()}
}
\value{
Data frame with columns:
\describe{
\item{grna_id}{gRNA identifier from input}
\item{gc_content}{Overall GC fraction (0-1)}
\item{gc_count}{Absolute GC count}
\item{gc_proximal}{GC fraction in PAM-proximal 10nt (positions 11-20)}
\item{gc_distal}{GC fraction in PAM-distal 10nt (positions 1-10)}
\item{max_homopolymer}{Length of longest homopolymer run}
\item{has_polyT/A/G/C}{Binary flags for NNNN runs}
\item{freq_XX}{Dinucleotide frequencies (16 features)}
\item{posN_X}{Position-specific nucleotide indicators (80 features)}
\item{estimated_tm}{Wallace rule Tm approximation}
\item{self_complement_score}{Simple self-complementarity metric}
\item{linguistic_complexity}{K-mer diversity measure}
\item{pre_pam_X}{Nucleotide at position 20 (4 binary features)}
\item{exon_rank}{Exon position from input}
}
}
\description{
Computes a comprehensive set of sequence-based features for each gRNA
to enable Shapley value analysis of scoring method behavior.
}
\details{
Features are designed for Cas9 with 20nt protospacers. The function
automatically handles sequences of different lengths but interpretation
of positional features assumes standard Cas9 geometry.

Feature categories:
\describe{
\item{Compositional}{GC content (global, regional), nucleotide counts}
\item{Positional}{Position-specific nucleotide indicators for all 20 positions}
\item{Sequence patterns}{Dinucleotide frequencies, homopolymer runs}
\item{Structural proxies}{Self-complementarity, linguistic complexity}
\item{Thermodynamic proxies}{Estimated Tm (Wallace rule)}
}
}
\examples{
\dontrun{
library(BSgenome.Hsapiens.UCSC.hg38)

# Get scored gRNAs
exons <- get_exon_structures("ENST00000269305", "hsapiens", output = "GRanges")
sites <- find_cas9_sites(exons, BSgenome.Hsapiens.UCSC.hg38)
scores <- score_grnas_multi(sites)

# Extract features
features <- extract_grna_features(scores)
dim(features)  # n_gRNAs x 113 features
}

}
\seealso{
\code{\link{compute_shap_targets}} for target variable computation,
\code{\link{analyze_feature_importance}} for SHAP analysis
}
