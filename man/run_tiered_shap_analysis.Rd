% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SHAP_analysis.R
\name{run_tiered_shap_analysis}
\alias{run_tiered_shap_analysis}
\title{Run tiered SHAP analysis across consensus metrics}
\usage{
run_tiered_shap_analysis(
  batch_result,
  modern_methods = c("deepspcas9", "deephf", "ruleset3"),
  legacy_methods = c("ruleset1"),
  n_top_features = 25,
  include_method_specific = FALSE,
  rasterize = NULL,
  raster_dpi = 300,
  quiet = FALSE
)
}
\arguments{
\item{batch_result}{A mutateR_consensus_batch object}

\item{modern_methods}{Character vector. Modern scoring methods.
Default: c("deepspcas9", "deephf", "ruleset3")}

\item{legacy_methods}{Character vector. Legacy methods.
Default: c("ruleset1")}

\item{n_top_features}{Integer. Number of top features to extract (default 25)}

\item{include_method_specific}{Logical. Also run SHAP for individual methods (default FALSE)}

\item{rasterize}{Logical. Rasterize beeswarm plots (default TRUE if n > 5000)}

\item{raster_dpi}{Integer. DPI for rasterisation (default 300)}

\item{quiet}{Logical. Suppress progress messages (default FALSE)}
}
\value{
A list of class "mutateR_tiered_shap" containing:
\describe{
\item{modern_quality}{SHAP for quality_percentile_modern}
\item{modern_discord}{SHAP for discordance_modern}
\item{legacy_divergence}{SHAP for ruleset1_divergence}
\item{robust_quality}{SHAP for quality_percentile_robust}
\item{comparison}{Feature ranking comparison across analyses}
\item{method_specific}{(optional) Individual method SHAP results}
\item{metadata}{Analysis parameters and completion status}
}
}
\description{
Executes SHAP analysis for multiple target variables representing different
aspects of gRNA quality and method agreement.
}
\details{
The four tiers address different analytical questions:

\strong{modern_quality:} What features predict high efficacy according to
modern deep learning methods?

\strong{modern_discord:} What features cause modern methods to disagree?

\strong{legacy_divergence:} What features does legacy methods "miss" that modern
methods capture?

\strong{robust_quality:} What features predict quality using outlier-resistant
statistics? Provides a conservative consensus view.
}
\examples{
\dontrun{
library(BSgenome.Hsapiens.UCSC.hg38)

# Run batch analysis
batch <- analyze_score_consensus(
  c("TP53", "BRCA1", "EGFR", "MYC", "KRAS"),
  "hsapiens",
  BSgenome.Hsapiens.UCSC.hg38
)

# Run tiered SHAP
shap_results <- run_tiered_shap_analysis(batch)

# View results
print(shap_results)

# Access individual analyses
shap_results$modern_quality$plots$beeswarm
shap_results$legacy_divergence$plots$beeswarm

# Compare feature rankings across tiers
shap_results$comparison
}

}
\seealso{
\code{\link{analyze_feature_importance}} for single-target analysis,
\code{\link{compare_shap_analyses}} for pairwise comparison
}
